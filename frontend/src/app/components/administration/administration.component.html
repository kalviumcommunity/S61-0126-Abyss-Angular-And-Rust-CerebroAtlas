<app-sidebar [userStatus]="'Online'" [userName]="'Dr. Sarah'"></app-sidebar>

<div class="admin-container">
  <div class="page-header">
    <div class="title-block">
      <h1>Administration</h1>
      <p>Manage users, roles, and system settings</p>
    </div>
    <button class="add-user-btn" [routerLink]="'/administration/add-user'">
      <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
        <circle cx="12" cy="7" r="4"></circle>
        <line x1="12" y1="12" x2="12" y2="18"></line>
        <line x1="9" y1="15" x2="15" y2="15"></line>
      </svg>
      Add User
    </button>
  </div>

  <!-- Stats Cards -->
  <div class="stats-row">
    <div class="stat-card" *ngFor="let stat of stats">
      <div class="stat-icon {{stat.icon}}">
        <svg *ngIf="stat.icon === 'users'" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path>
          <circle cx="9" cy="7" r="4"></circle>
          <path d="M23 21v-2a4 4 0 0 0-3-3.87"></path>
          <path d="M16 3.13a4 4 0 0 1 0 7.75"></path>
        </svg>
        <svg *ngIf="stat.icon === 'active'" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
          <circle cx="12" cy="7" r="4"></circle>
          <circle cx="12" cy="12" r="1"></circle>
        </svg>
        <svg *ngIf="stat.icon === 'inactive'" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
          <circle cx="12" cy="7" r="4"></circle>
          <line x1="9" y1="12" x2="15" y2="12"></line>
        </svg>
        <svg *ngIf="stat.icon === 'roles'" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path>
          <polyline points="14 2 14 8 20 8"></polyline>
          <line x1="12" y1="13" x2="8" y2="13"></line>
          <line x1="12" y1="17" x2="8" y2="17"></line>
        </svg>
      </div>
      <div class="stat-value">{{stat.value}}</div>
      <div class="stat-label">{{stat.label}}</div>
    </div>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <button class="tab" [class.active]="activeTab === 'users'" (click)="switchTab('users')">Users</button>
    <button class="tab" [class.active]="activeTab === 'roles'" (click)="switchTab('roles')">Roles & Permissions</button>
    <button class="tab" [class.active]="activeTab === 'settings'" (click)="switchTab('settings')">System Settings</button>
  </div>

  <!-- User Management Tab -->
  <div class="tab-content" *ngIf="activeTab === 'users'">
    <div class="user-management-card">
      <div class="card-header">
        <h2>User Management</h2>
        <p>Manage system users and their access</p>
        <input type="text" class="search-input" placeholder="Search users..." [(ngModel)]="searchQuery" />
      </div>

      <div class="users-list">
        <div class="user-item" *ngFor="let user of filteredUsers">
          <div class="user-avatar" [ngClass]="user.status">{{user.initials}}</div>
          <div class="user-main">
            <div class="user-name">{{user.name}}</div>
            <div class="user-email">{{user.email}}</div>
          </div>
          <div class="user-details">
            <span class="badge role">{{user.role}}</span>
            <span class="department">{{user.department}}</span>
          </div>
          <div class="user-meta">
            <div class="last-login">Last login</div>
            <div class="login-time">{{user.lastLogin}}</div>
          </div>
          <div class="user-status" [ngClass]="user.status">
            <span class="status-dot"></span>
            {{user.status}}
          </div>
          <button class="menu-btn">â‹®</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Roles & Permissions Tab -->
  <div class="tab-content" *ngIf="activeTab === 'roles'">
    <div class="roles-card">
      <div class="card-header">
        <div class="header-left">
          <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
          </svg>
          <div>
            <h2>Roles & Permissions</h2>
            <p>Define access levels for different user types</p>
          </div>
        </div>
        <button class="create-role-btn" (click)="openCreateRoleModal()">
          <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <circle cx="12" cy="12" r="10"></circle>
            <line x1="12" y1="8" x2="12" y2="16"></line>
            <line x1="8" y1="12" x2="16" y2="12"></line>
          </svg>
          Create Role
        </button>
      </div>

      <div class="roles-list">
        <div class="role-item" *ngFor="let role of roles">
          <div class="role-icon" [ngClass]="role.color">
            <svg *ngIf="role.icon === 'shield'" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"></path>
            </svg>
            <svg *ngIf="role.icon === 'user'" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path>
              <circle cx="12" cy="7" r="4"></circle>
            </svg>
            <svg *ngIf="role.icon === 'heart'" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
            </svg>
            <svg *ngIf="role.icon === 'flask'" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M9 3h6v7.5l4 7.5H5l4-7.5V3z"></path>
              <path d="M6.2 21h11.6"></path>
            </svg>
            <svg *ngIf="role.icon === 'calendar'" xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
              <line x1="16" y1="2" x2="16" y2="6"></line>
              <line x1="8" y1="2" x2="8" y2="6"></line>
              <line x1="3" y1="10" x2="21" y2="10"></line>
            </svg>
          </div>
          <div class="role-info">
            <div class="role-name">{{role.name}}</div>
            <div class="role-description">{{role.description}}</div>
          </div>
          <div class="role-users">{{role.users}} users</div>
          <button class="edit-btn">
            <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"></path>
              <path d="M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"></path>
            </svg>
            Edit
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- System Settings Tab -->
  <div class="tab-content" *ngIf="activeTab === 'settings'">
    <div class="settings-card">
      <div class="card-header">
        <svg xmlns="http://www.w3.org/2000/svg" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <circle cx="12" cy="12" r="3"></circle>
          <path d="M12 1v6m0 6v6m-9-9h6m6 0h6M4.93 4.93l4.24 4.24m6.36 6.36l4.24 4.24m0-13.42l-4.24 4.24m-6.36 6.36L4.93 19.07"></path>
        </svg>
        <div>
          <h2>System Settings</h2>
          <p>Configure system-wide security and behavior settings</p>
        </div>
      </div>

      <div class="settings-list">
        <div class="setting-item" *ngFor="let setting of systemSettings">
          <div class="setting-info">
            <div class="setting-name">{{setting.name}}</div>
            <div class="setting-description">{{setting.description}}</div>
          </div>
          <div class="setting-control">
            <select *ngIf="setting.type === 'select'" class="setting-select" [(ngModel)]="setting.value">
              <option *ngFor="let option of setting.options" [value]="option">{{option}}</option>
            </select>
            <label *ngIf="setting.type === 'toggle'" class="switch">
              <input type="checkbox" [(ngModel)]="setting.value">
              <span class="slider"></span>
            </label>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Create Role Modal -->
<div class="modal-overlay" *ngIf="showCreateRoleModal" (click)="closeCreateRoleModal()">
  <div class="modal-content" (click)="$event.stopPropagation()">
    <div class="modal-header">
      <h2>Create New Role</h2>
      <button class="close-btn" (click)="closeCreateRoleModal()">
        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="18" y1="6" x2="6" y2="18"></line>
          <line x1="6" y1="6" x2="18" y2="18"></line>
        </svg>
      </button>
    </div>

    <div class="modal-body">
      <!-- Basic Information -->
      <div class="form-section">
        <h3>Basic Information</h3>
        <div class="form-row">
          <div class="form-group">
            <label>Role Name *</label>
            <input type="text" [(ngModel)]="newRole.name" placeholder="e.g., Pharmacist" />
          </div>
          <div class="form-group">
            <label>Color Theme</label>
            <select [(ngModel)]="newRole.color">
              <option value="red">Red</option>
              <option value="teal">Teal</option>
              <option value="blue">Blue</option>
              <option value="green">Green</option>
              <option value="amber">Amber</option>
              <option value="purple">Purple</option>
            </select>
          </div>
        </div>

        <div class="form-group full-width">
          <label>Description *</label>
          <textarea [(ngModel)]="newRole.description" placeholder="Describe the role's responsibilities" rows="3"></textarea>
        </div>

        <div class="form-group">
          <label>Icon</label>
          <select [(ngModel)]="newRole.icon">
            <option value="user">User</option>
            <option value="shield">Shield</option>
            <option value="heart">Heart</option>
            <option value="flask">Flask</option>
            <option value="calendar">Calendar</option>
          </select>
        </div>
      </div>

      <!-- Permissions -->
      <div class="form-section">
        <h3>Permissions</h3>
        <p class="section-desc">Define what this role can access and modify</p>
        
        <div class="permissions-grid">
          <div class="permission-row">
            <span class="permission-label">Patient Records</span>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.patientRecords.read" />
              Read
            </label>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.patientRecords.write" />
              Write
            </label>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.patientRecords.delete" />
              Delete
            </label>
          </div>

          <div class="permission-row">
            <span class="permission-label">Medical Records</span>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.medicalRecords.read" />
              Read
            </label>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.medicalRecords.write" />
              Write
            </label>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.medicalRecords.delete" />
              Delete
            </label>
          </div>

          <div class="permission-row">
            <span class="permission-label">Prescriptions</span>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.prescriptions.read" />
              Read
            </label>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.prescriptions.write" />
              Write
            </label>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.prescriptions.delete" />
              Delete
            </label>
          </div>

          <div class="permission-row">
            <span class="permission-label">Appointments</span>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.appointments.read" />
              Read
            </label>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.appointments.write" />
              Write
            </label>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.appointments.delete" />
              Delete
            </label>
          </div>

          <div class="permission-row">
            <span class="permission-label">Lab Results</span>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.labResults.read" />
              Read
            </label>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.labResults.write" />
              Write
            </label>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.labResults.delete" />
              Delete
            </label>
          </div>

          <div class="permission-row">
            <span class="permission-label">Reports</span>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.reports.read" />
              Read
            </label>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.reports.write" />
              Write
            </label>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.reports.delete" />
              Delete
            </label>
          </div>

          <div class="permission-row">
            <span class="permission-label">User Management</span>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.userManagement.read" />
              Read
            </label>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.userManagement.write" />
              Write
            </label>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.userManagement.delete" />
              Delete
            </label>
          </div>

          <div class="permission-row">
            <span class="permission-label">System Settings</span>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.systemSettings.read" />
              Read
            </label>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.systemSettings.write" />
              Write
            </label>
            <label class="checkbox-label">
              <input type="checkbox" [(ngModel)]="newRole.permissions.systemSettings.delete" />
              Delete
            </label>
          </div>
        </div>
      </div>
    </div>

    <div class="modal-footer">
      <button class="btn-cancel" (click)="closeCreateRoleModal()">Cancel</button>
      <button class="btn-create" (click)="createRole()" [disabled]="!newRole.name || !newRole.description">Create Role</button>
    </div>
  </div>
</div>
